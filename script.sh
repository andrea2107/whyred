#!/bin/bashdpkg --add-architecture i386 && apt-get update && apt-get install -y git ccache automake bc lzop bison gperf build-essential zip curl zlib1g-dev zlib1g-dev:i386 g++-multilib python-networkx libxml2-utils bzip2 libbz2-dev libbz2-1.0 libghc-bzlib-dev squashfs-tools pngcrush schedtool dpkg-dev liblz4-tool make optipng &&git clone https://android.googlesource.com/platform/prebuilts/gcc/linux-x86/aarch64/aarch64-linux-android-4.9 /pipeline/build/root/toolchain/aarch64-linux-android-4.9git clone https://android.googlesource.com/platform/prebuilts/clang/host/linux-x86 /pipeline/build/root/toolchain/aarch64-linux-android-clangKERNEL_DIR=$PWDANYKERNEL_DIR=$KERNEL_DIR/AnyKernel2TOOLCHAINDIR=/pipeline/build/root/toolchain/aarch64-linux-android-4.9CCACHEDIR=../CCACHE/whyredDATE=$(date +"%d%m%Y")KERNEL_NAME="Lasagnatest-Kernel"DEVICE="-whyred-"VER="-v0.0.1"TYPE="-O-MR1"FINAL_ZIP="$KERNEL_NAME""$DEVICE""$DATE""$TYPE""$VER".ziprm $ANYKERNEL_DIR/Image.gz-dtbrm $KERNEL_DIR/arch/arm64/boot/Image.gz $KERNEL_DIR/arch/arm64/boot/Image.gz-dtbexport ARCH=arm64export CXX="/pipeline/build/root/toolchain/aarch64-linux-android-clang/clang-4679922/bin/clang++"export CC="/pipeline/build/root/toolchain/aarch64-linux-android-clang/clang-4679922/bin/clang"export CLANG_TRIPLE=aarch64-linux-gnu-export KBUILD_BUILD_USER="Andrea"export KBUILD_BUILD_HOST="SlaveBuilder"export CROSS_COMPILE=/pipeline/build/root/toolchain/aarch64-linux-android-4.9/bin/aarch64-linux-android-export LD_LIBRARY_PATH=/pipeline/build/root/toolchain/aarch64-linux-android-4.9/lib/export USE_CCACHE=1export CCACHE_DIR=$CCACHEDIR/.ccachecurl -s -X POST https://api.telegram.org/bot$BOT_API_KEY/sendMessage -d text="New kernel build started for whyred!" -d chat_id=@andreabuilds;make clean && make mrpropermake whyred_defconfigmake -j$( nproc --all ){  #try blockcp $KERNEL_DIR/arch/arm64/boot/Image.gz-dtb $ANYKERNEL_DIR} || {#catch block  if [ $? != 0 ]; then    curl -s -X POST https://api.telegram.org/bot$BOT_API_KEY/sendMessage -d text="Build failed :c" -d chat_id=@andreabuilds;    exit 1  fi}cd $ANYKERNEL_DIRzip -r9 $FINAL_ZIP * -x *.zip $FINAL_ZIPmessage="Build completed with the latest commit -"curl -s -X POST https://api.telegram.org/bot$BOT_API_KEY/sendMessage -d text="$message $(git log --pretty=format:'%h : %s' -1)" -d chat_id=@andreabuildscurl -F chat_id="-1001235553927" -F document=@"$FINAL_ZIP" https://api.telegram.org/bot$BOT_API_KEY/sendDocumentcurl -F chat_id="-1001235553927" -F document=@"$KERNEL_DIR/include/generated/compile.h" https://api.telegram.org/bot$BOT_API_KEY/sendDocumentmv $FINAL_ZIP /pipeline/output/$FINAL_ZIP